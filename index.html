<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Loryez</title><link rel="icon" type="image/x-icon" href="https://styles.redditmedia.com/t5_6xhgie/styles/communityIcon_8kgc2fy21dcb1.jpeg?width=128&frame=1&auto=webp&s=2f9049eda6789be694672b93c66064e8007c11bf"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600&family=Space+Grotesk:wght@400;500;600&family=Comfortaa:wght@700&family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&family=Raleway:wght@400;500;600;700&display=swap" rel="stylesheet"><style>:root{--bg-primary:#050508;--bg-secondary:#0a0a12;--bg-tertiary:#0f0f1a;--bg-accent:#151522;--text-primary:#f5f5ff;--text-secondary:#d0d0f0;--text-muted:#8a8ac0;--accent-primary:#8b5ceb;--accent-secondary:#6d3bd4;--accent-tertiary:#9d7af0;--accent-quaternary:#4a2a8c;--accent-glow:rgba(139,92,235,0.25);--accent-glow-strong:rgba(139,92,235,0.4);--success:#6ceb8b;--warning:#ebc46c;--error:#eb6c6c;--info:#6c9beb;--border-thin:1px solid rgba(139,92,235,0.1);--border-medium:1px solid rgba(139,92,235,0.2);--border-thick:1px solid rgba(139,92,235,0.3);--shadow-soft:0 4px 12px rgba(0,0,0,0.4);--shadow-medium:0 8px 24px rgba(0,0,0,0.6);--shadow-glow:0 0 20px rgba(139,92,235,0.5);--radius-sm:8px;--radius-md:12px;--radius-lg:16px;--radius-xl:20px}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Poppins',sans-serif;background-color:var(--bg-primary);color:var(--text-primary);line-height:1.6;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;background-image:radial-gradient(circle at 10% 20%,rgba(139,92,235,0.05) 0%,transparent 40%),radial-gradient(circle at 90% 80%,rgba(109,59,212,0.05) 0%,transparent 40%),linear-gradient(135deg,var(--bg-primary) 0%,var(--bg-secondary) 100%);min-height:100vh}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:4px}::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,var(--accent-primary),var(--accent-secondary));border-radius:4px}::-webkit-scrollbar-thumb:hover{background:linear-gradient(to bottom,var(--accent-secondary),var(--accent-quaternary))}.top-nav{display:flex;justify-content:center;align-items:center;gap:16px;padding:20px;background:linear-gradient(135deg,rgba(10,10,18,0.9),rgba(15,15,26,0.9));backdrop-filter:blur(15px);border-bottom:2px solid var(--accent-primary);position:sticky;top:0;z-index:1000;box-shadow:0 4px 20px rgba(0,0,0,0.3)}.nav-link{display:flex;align-items:center;gap:10px;color:var(--text-secondary);text-decoration:none;font-family:'Montserrat',sans-serif;font-weight:600;font-size:1.1rem;padding:12px 24px;border-radius:var(--radius-md);transition:all 0.4s ease;cursor:pointer;position:relative;overflow:hidden;background:rgba(15,15,26,0.7);border:1px solid rgba(139,92,235,0.2);box-shadow:0 4px 12px rgba(0,0,0,0.2)}.nav-link::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));opacity:0;transition:opacity 0.4s ease;z-index:-1;border-radius:var(--radius-md)}.nav-link::after{content:'';position:absolute;top:50%;left:50%;width:0;height:0;background:rgba(255,255,255,0.1);border-radius:50%;transform:translate(-50%,-50%);transition:width 0.6s ease,height 0.6s ease}.nav-link:hover,.nav-link.active{color:var(--text-primary);transform:translateY(-4px);box-shadow:0 8px 20px rgba(139,92,235,0.3);border-color:var(--accent-primary)}.nav-link.active::before{opacity:1}.nav-link:hover::after{width:300px;height:300px}.nav-link svg{transition:all 0.4s ease;filter:drop-shadow(0 0 5px rgba(139,92,235,0.5))}.nav-link.active svg{filter:drop-shadow(0 0 8px rgba(255,255,255,0.7));transform:scale(1.1)}.tab-content{padding:2.5rem}.hidden{display:none}.main-container{display:grid;grid-template-columns:minmax(0,2fr) minmax(0,1.2fr);gap:32px;max-width:1400px;margin:0 auto}.column{display:flex;flex-direction:column;gap:32px}.card{background:linear-gradient(135deg,var(--bg-secondary),var(--bg-tertiary));border-radius:var(--radius-xl);padding:32px;border:1px solid rgba(139,92,235,0.15);box-shadow:var(--shadow-soft);transition:all 0.4s ease;position:relative;overflow:hidden}.static-card{background:linear-gradient(135deg,var(--bg-secondary),var(--bg-tertiary));border-radius:var(--radius-xl);padding:32px;border:1px solid rgba(139,92,235,0.15);box-shadow:var(--shadow-soft);position:relative;overflow:hidden}#search-block{overflow:visible}.static-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(to right,var(--accent-primary),var(--accent-secondary),var(--accent-tertiary));opacity:0.8}#search-block::before{display:none}.static-card::after{content:'';position:absolute;top:0;right:0;width:100px;height:100px;background:radial-gradient(circle,rgba(139,92,235,0.1) 0%,transparent 70%);border-radius:50%;transform:translate(30%,-30%);z-index:0}.card::before{content:'';position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(to right,var(--accent-primary),var(--accent-secondary),var(--accent-tertiary));opacity:0.8;transition:opacity 0.4s ease}.card::after{content:'';position:absolute;top:0;right:0;width:100px;height:100px;background:radial-gradient(circle,rgba(139,92,235,0.1) 0%,transparent 70%);border-radius:50%;transform:translate(30%,-30%);z-index:0}.card:hover::before{opacity:1}.card:hover{box-shadow:var(--shadow-glow);transform:translateY(-5px);border-color:rgba(139,92,235,0.3)}.full-width{grid-column:1/-1}h2{font-family:'Raleway',sans-serif;font-size:1.8rem;font-weight:700;margin-bottom:24px;letter-spacing:-0.5px;color:var(--text-primary);position:relative;padding-bottom:12px;text-shadow:0 2px 4px rgba(0,0,0,0.3)}h2::after{content:'';position:absolute;bottom:0;left:0;width:60px;height:4px;background:linear-gradient(to right,var(--accent-primary),var(--accent-secondary));border-radius:2px;box-shadow:0 0 8px var(--accent-glow)}h3{font-family:'Montserrat',sans-serif;font-size:1.3rem;font-weight:600;margin-bottom:16px;color:var(--text-primary);text-shadow:0 1px 2px rgba(0,0,0,0.3)}.tabs{display:flex;gap:8px;margin-bottom:24px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));padding:8px;border-radius:var(--radius-md);border:var(--border-thin);box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}.tab-button{background:transparent;border:none;color:var(--text-secondary);padding:14px 20px;border-radius:var(--radius-sm);cursor:pointer;transition:all 0.4s ease;flex:1;font-weight:600;font-size:1rem;font-family:'Montserrat',sans-serif;position:relative;overflow:hidden}.tab-button::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));opacity:0;transition:opacity 0.4s ease;z-index:-1;border-radius:var(--radius-sm)}.tab-button.active{color:var(--text-primary);transform:translateY(-3px);text-shadow:0 0 8px rgba(255,255,255,0.5)}.tab-button.active::before{opacity:1}.tab-button:not(.active):hover{background-color:rgba(139,92,235,0.1);color:var(--text-primary);transform:translateY(-2px)}.search-wrapper{position:relative}#search-input{width:100%;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);padding:18px 22px;color:var(--text-primary);font-size:1.05rem;transition:all 0.4s ease;font-family:'Poppins',sans-serif;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}#search-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-glow),inset 0 2px 4px rgba(0,0,0,0.2)}#search-results-list{position:absolute;top:100%;left:0;right:0;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-top:none;border-radius:0 0 var(--radius-md) var(--radius-md);z-index:1000;max-height:320px;overflow-y:auto;box-shadow:var(--shadow-medium)}.search-result-item{padding:16px 20px;cursor:pointer;display:flex;align-items:center;gap:16px;transition:all 0.3s ease;border-bottom:var(--border-thin)}.search-result-item:last-child{border-bottom:none}.search-result-item:hover{background:rgba(139,92,235,0.1)}.search-result-item img{width:45px;height:65px;object-fit:cover;border-radius:var(--radius-sm);box-shadow:0 4px 8px rgba(0,0,0,0.3)}.search-result-item p{font-weight:500;font-family:'Montserrat',sans-serif}.search-result-item span{font-size:0.9rem;color:var(--text-muted)}#search-preview.static-card{margin-top:24px;display:flex;flex-direction:column;gap:24px}.preview-content{display:flex;gap:24px}.preview-content .poster{width:190px;height:285px;object-fit:cover;border-radius:var(--radius-md);flex-shrink:0;box-shadow:var(--shadow-soft);border:2px solid rgba(139,92,235,0.2)}.preview-content .synopsis{font-size:1rem;margin-top:16px;line-height:1.6;max-height:150px;overflow-y:auto;color:var(--text-secondary);padding-right:10px}.continue-button,.pay-button{background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));color:var(--text-primary);border:none;border-radius:var(--radius-md);padding:18px 28px;font-weight:600;font-size:1.05rem;cursor:pointer;transition:all 0.4s ease;text-align:center;width:100%;display:flex;align-items:center;justify-content:center;gap:12px;text-decoration:none;font-family:'Raleway',sans-serif;box-shadow:var(--shadow-soft);position:relative;overflow:hidden;text-shadow:0 1px 2px rgba(0,0,0,0.3)}.continue-button::before,.pay-button::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.6s ease}.continue-button:hover::before,.pay-button:hover::before{left:100%}.continue-button:hover,.pay-button:hover{transform:translateY(-4px);box-shadow:var(--shadow-glow)}.classificacao-box{border-left:4px solid var(--accent-primary);background:linear-gradient(90deg,rgba(139,92,235,0.15),transparent);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:20px;margin-bottom:24px;box-shadow:0 4px 12px rgba(0,0,0,0.2)}.classificacao-box p{font-size:1.05rem;margin-bottom:10px;font-family:'Montserrat',sans-serif}.classificacao-box span{font-size:0.95rem;color:var(--warning);display:block;margin-top:10px}.config-group{margin-bottom:32px}.checkbox-group label{display:flex;align-items:center;gap:14px;padding:16px;font-size:1rem;cursor:pointer;border-radius:var(--radius-md);transition:background-color 0.3s ease;border:var(--border-thin);background:rgba(15,15,26,0.5)}.checkbox-group label:hover{background:rgba(139,92,235,0.1)}input[type="checkbox"]{appearance:none;width:24px;height:24px;border:2px solid var(--border-medium);border-radius:var(--radius-sm);background-color:var(--bg-tertiary);cursor:pointer;position:relative;transition:all 0.3s ease}input[type="checkbox"]:checked{background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));border-color:transparent;transform:scale(1.1)}input[type="checkbox"]:checked::after{content:'✔';position:absolute;color:white;font-size:14px;top:50%;left:50%;transform:translate(-50%,-50%);text-shadow:0 1px 2px rgba(0,0,0,0.3)}.select-input{width:100%;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);padding:16px;color:var(--text-secondary);font-size:1rem;appearance:none;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23d0d0f0' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 1rem center;background-size:1em;transition:all 0.3s ease;font-family:'Poppins',sans-serif;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}.select-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-glow),inset 0 2px 4px rgba(0,0,0,0.2)}.select-input option{background:var(--bg-accent);color:var(--text-secondary)}.number-input-wrapper{display:flex;justify-content:space-between;align-items:center;padding:0 14px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border-radius:var(--radius-md);border:var(--border-medium);box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}.number-input-wrapper input{background:none;border:none;outline:none;color:var(--text-primary);text-align:center;width:60px;font-size:1.05rem;font-family:'Montserrat',sans-serif}.num-btn{background:none;border:none;color:var(--text-secondary);font-size:1.6rem;cursor:pointer;padding:0 10px;border-radius:6px;transition:background-color 0.3s}.num-btn:hover{background-color:rgba(139,92,235,0.2);color:var(--text-primary)}#summary-content .poster{width:90px;height:135px;object-fit:cover;border-radius:var(--radius-md);box-shadow:var(--shadow-soft);border:2px solid rgba(139,92,235,0.2)}#price-breakdown{padding:18px 0}#price-breakdown p{display:flex;justify-content:space-between;color:var(--text-secondary);font-size:1rem;margin-bottom:14px;padding:10px 0;border-bottom:var(--border-thin)}#price-breakdown p:last-child{border-bottom:none}.divider{height:2px;background:linear-gradient(to right,transparent,var(--accent-primary),transparent);margin:18px 0}.total{display:flex;justify-content:space-between;align-items:baseline;padding-top:18px}.total .total-text{font-size:1.4rem;font-weight:600;font-family:'Raleway',sans-serif}.total .price{font-family:'Raleway',sans-serif;font-size:2.2rem;font-weight:700;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 10px rgba(139,92,235,0.4)}#pay-button{margin-top:28px}.pay-button.disabled{background:var(--bg-tertiary);color:var(--text-muted);cursor:not-allowed;transform:none;box-shadow:none}.pay-button.disabled:hover{background:var(--bg-tertiary);transform:none;box-shadow:none}.pay-button.disabled::before{display:none}.placeholder{padding:18px;color:var(--text-muted);text-align:center;font-style:italic;font-family:'Poppins',sans-serif}.info-box{grid-column:1/-1;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border-radius:var(--radius-xl);padding:28px;margin-top:20px;border:var(--border-thin);position:relative;box-shadow:var(--shadow-soft)}.info-box ul{padding-left:24px;color:var(--text-secondary);font-size:1rem;line-height:1.8}.info-box li{margin-bottom:10px;position:relative}.info-box li::before{content:'▶';position:absolute;left:-20px;color:var(--accent-primary);font-size:0.9rem}.nudez-episodes-config{margin-top:20px;padding:18px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border-radius:var(--radius-md);border:var(--border-medium);box-shadow:0 4px 12px rgba(0,0,0,0.2)}.change-button{background:transparent;border:var(--border-medium);color:var(--accent-primary);padding:10px 18px;border-radius:var(--radius-md);cursor:pointer;font-size:0.95rem;font-weight:600;transition:all 0.3s;font-family:'Montserrat',sans-serif}.change-button:hover{background-color:var(--accent-primary);color:var(--text-primary);border-color:var(--accent-primary);transform:translateY(-2px)}.nudez-checkbox{border:2px solid var(--accent-primary)!important}.discount-notice,.warning-notice,.error-notice,.list-info-notice{font-size:0.95rem;margin-top:10px;font-weight:500;padding:14px 18px;border-radius:var(--radius-md);border-left:5px solid;font-family:'Montserrat',sans-serif;box-shadow:0 4px 12px rgba(0,0,0,0.2)}.discount-notice{color:var(--success);background:linear-gradient(90deg,rgba(108,235,139,0.15),transparent);border-color:var(--success)}.warning-notice{color:var(--warning);background:linear-gradient(90deg,rgba(235,196,108,0.15),transparent);border-color:var(--warning)}.error-notice{color:var(--error);background:linear-gradient(90deg,rgba(235,108,108,0.15),transparent);border-color:var(--error)}.list-info-notice{color:var(--info);background:linear-gradient(90deg,rgba(108,155,235,0.15),transparent);border-color:var(--info)}.media-info{color:var(--text-muted)!important;font-size:0.95rem;margin-top:6px}.info-content{background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);padding:28px;margin:28px 0;position:relative;box-shadow:0 4px 12px rgba(0,0,0,0.2)}.info-content::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(to bottom,var(--accent-secondary),var(--accent-primary))}.info-content h4{margin-bottom:14px;font-size:1.2rem;color:var(--text-primary);font-family:'Raleway',sans-serif}.info-content ul{padding-left:24px;color:var(--text-secondary);font-size:1rem}.studio-list,.release-info{font-family:'Montserrat',sans-serif;font-size:1.05rem;margin-top:10px;line-height:1.5;font-weight:500}.studio-list{color:var(--accent-primary)}.release-info{color:var(--accent-tertiary)}.content-info-spacing{margin:24px 0}.option-label{display:block;margin-bottom:10px;font-weight:500;color:var(--text-primary);font-family:'Montserrat',sans-serif}.episode-selector{margin-top:20px;border:var(--border-medium);border-radius:var(--radius-md);padding:18px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));box-shadow:0 4px 12px rgba(0,0,0,0.2)}.episode-item{display:flex;align-items:center;margin-bottom:6px;padding:14px;border-radius:var(--radius-sm);transition:background-color 0.3s;gap:14px;border-bottom:var(--border-thin)}.episode-item:last-child{border-bottom:none}.episode-item:hover{background:rgba(139,92,235,0.1)}.episode-info{flex:1}.episode-duration{color:var(--text-muted);font-size:0.9rem;margin-left:14px}.nudez-warning{background:linear-gradient(90deg,rgba(235,196,108,0.15),transparent);border-left:5px solid var(--warning);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:14px 18px;margin-top:14px;font-size:1.05rem;color:var(--warning);font-weight:500}.episode-scroll-container{max-height:320px;overflow-y:auto;margin-top:14px;padding-right:10px}.grito-notice{background:linear-gradient(90deg,rgba(255,215,0,0.15),transparent);border-left:5px solid gold;border-radius:0 var(--radius-md) var(--radius-md) 0;padding:18px 22px;margin:24px 0;font-size:1.05rem;color:gold;text-align:center;font-weight:600;font-family:'Raleway',sans-serif;box-shadow:0 4px 12px rgba(0,0,0,0.2)}.loading{display:inline-block;width:22px;height:22px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:var(--accent-primary);animation:spin 1s ease-in-out infinite}@keyframes spin{to{transform:rotate(360deg)}}.episodes-count{display:flex;gap:24px;margin-top:14px;font-size:0.95rem;justify-content:center}.episodes-count div{display:flex;flex-direction:column;align-items:center}.episodes-count strong{color:var(--text-primary);font-size:1.7rem;margin-bottom:6px;font-family:'Raleway',sans-serif;font-weight:700}.episodes-count span{color:var(--text-muted);font-size:0.95rem}.already-sponsored{color:var(--success);font-weight:500;margin-left:10px;font-size:0.9rem}.season-sponsored-notice{background:linear-gradient(90deg,rgba(108,235,139,0.15),transparent);border-left:5px solid var(--success);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:14px 18px;margin:14px 0;font-size:0.95rem;color:var(--success)}.sponsored-message{background:linear-gradient(90deg,rgba(108,235,139,0.15),transparent);border-left:5px solid var(--success);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:22px;margin:20px 0;text-align:center;color:var(--success)}.sponsored-movie-notice{background:linear-gradient(90deg,rgba(235,108,108,0.15),transparent);border-left:5px solid var(--error);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:22px;margin:20px 0;text-align:center;color:var(--error);font-family:'Raleway',sans-serif;font-size:1rem;font-weight:600}.season-info{background:linear-gradient(90deg,rgba(138,43,226,0.15),transparent);border-left:5px solid var(--accent-secondary);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:18px;margin:10px 0;text-align:center}.episodes-info{background:linear-gradient(90deg,rgba(255,107,53,0.15),transparent);border-left:5px solid var(--accent-tertiary);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:18px;margin:10px 0;text-align:center}.season-episodes{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}.season-episode-item{background-color:rgba(139,92,235,0.1);padding:8px 14px;border-radius:var(--radius-sm);font-size:0.9rem;border:var(--border-thin)}.completed-content-message{background:linear-gradient(90deg,rgba(108,235,139,0.15),transparent);border-left:5px solid var(--success);border-radius:0 var(--radius-md) var(--radius-md) 0;padding:22px;margin:20px 0;text-align:center}.completed-content-message p{margin-bottom:14px;font-weight:500}.episode-number{font-family:'Raleway',sans-serif;font-size:1.9rem;font-weight:700;color:var(--text-primary);margin-bottom:6px}.episode-label{color:var(--text-muted);font-size:0.95rem}.season-episode-count{font-family:'Raleway',sans-serif;font-size:1.15rem;font-weight:600}.continue-button .spinner{display:none;width:24px;height:24px;border:4px solid var(--text-primary);border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite}.continue-button.is-loading{cursor:wait}.continue-button.is-loading .spinner{display:inline-block}.continue-button.is-loading .button-text{display:none}.sponsored-section{max-width:1400px;margin:0 auto}.sponsored-section h2{border-left:5px solid var(--accent-primary);padding-left:18px;margin-bottom:28px}.media-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(190px,1fr));gap:28px;margin-bottom:52px}.media-card{background:linear-gradient(135deg,var(--bg-secondary),var(--bg-tertiary));border-radius:var(--radius-md);overflow:hidden;border:1px solid rgba(139,92,235,0.15);transition:all 0.4s ease;cursor:pointer;position:relative;box-shadow:var(--shadow-soft)}.media-card::before{content:'';position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(to right,var(--accent-primary),var(--accent-secondary));opacity:0.8;transition:opacity 0.4s ease}.media-card:hover::before{opacity:1}.media-card:hover{transform:translateY(-6px);box-shadow:var(--shadow-glow);border-color:var(--accent-primary)}.media-card img{width:100%;height:auto;display:block;aspect-ratio:2/3;object-fit:cover}.media-card-title{padding:16px;font-size:0.95rem;font-weight:600;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:'Montserrat',sans-serif}#loading-message,#assistidos-loading-message{text-align:center;font-size:1.3rem;color:var(--text-muted);margin-top:60px;font-family:'Poppins',sans-serif}.sponsored-search-controls{display:flex;gap:20px;margin-bottom:28px;position:relative}.sponsored-search-controls .search-wrapper{flex-grow:1}#sponsored-search-input{width:100%;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);padding:16px 22px;color:var(--text-primary);font-size:1.05rem;transition:all 0.4s ease;font-family:'Poppins',sans-serif;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}#sponsored-search-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-glow),inset 0 2px 4px rgba(0,0,0,0.2)}.filter-wrapper{position:relative}#filter-toggle-btn{height:100%;padding:0 18px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);color:var(--text-secondary);border-radius:var(--radius-md);cursor:pointer;transition:all 0.4s ease;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}#filter-toggle-btn:hover,#filter-toggle-btn.active{border-color:var(--accent-primary);color:var(--text-primary);transform:translateY(-2px)}#filter-dropdown{position:absolute;top:calc(100% + 10px);right:0;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);box-shadow:var(--shadow-medium);z-index:100;overflow:hidden;width:160px}#filter-dropdown.hidden{display:none}.filter-option{display:block;padding:14px 18px;color:var(--text-secondary);text-decoration:none;font-size:1rem;transition:background-color 0.3s;cursor:pointer;font-family:'Montserrat',sans-serif}.filter-option:hover{background:rgba(139,92,235,0.1);color:var(--text-primary)}.filter-option.active{background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));color:var(--text-primary);font-weight:600}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(5,5,8,0.9);backdrop-filter:blur(10px);z-index:2000;display:flex;justify-content:center;align-items:center;opacity:0;visibility:hidden;transition:all 0.4s ease}.modal-overlay.visible{opacity:1;visibility:visible}.modal-content{background:linear-gradient(135deg,var(--bg-secondary),var(--bg-tertiary));border-radius:var(--radius-xl);border:1px solid rgba(139,92,235,0.2);max-width:820px;width:90%;max-height:90vh;display:flex;gap:32px;padding:32px;position:relative;transform:scale(0.95);transition:all 0.4s ease;box-shadow:var(--shadow-glow)}.modal-overlay.visible .modal-content{transform:scale(1)}.modal-close{position:absolute;top:18px;right:22px;font-size:2.2rem;color:var(--text-muted);cursor:pointer;transition:color 0.3s;border:none;background:none;width:44px;height:44px;display:flex;align-items:center;justify-content:center;border-radius:50%}.modal-close:hover{color:var(--text-primary);background-color:rgba(139,92,235,0.2)}.modal-poster img{width:260px;height:auto;aspect-ratio:2/3;object-fit:cover;border-radius:var(--radius-md);flex-shrink:0;box-shadow:var(--shadow-soft);border:2px solid rgba(139,92,235,0.2)}.modal-details{overflow-y:auto;padding-right:14px}.modal-title{font-family:'Raleway',sans-serif;font-size:2.2rem;font-weight:700;margin-bottom:10px;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 10px rgba(139,92,235,0.4)}.modal-meta{display:flex;gap:14px;margin-bottom:28px;color:var(--text-muted);font-weight:500;flex-wrap:wrap}.modal-meta span{background:rgba(139,92,235,0.1);padding:8px 14px;border-radius:var(--radius-sm);font-size:0.95rem;border:var(--border-thin)}.modal-info-group{margin-bottom:24px}.modal-info-group strong{display:block;color:var(--text-primary);margin-bottom:10px;font-size:1.05rem;font-family:'Montserrat',sans-serif}.modal-info-group p{color:var(--text-secondary);line-height:1.6}.modal-genres{display:flex;gap:10px;flex-wrap:wrap}.modal-genres span{background:rgba(139,92,235,0.1);border:var(--border-thin);padding:8px 14px;border-radius:20px;font-size:0.9rem}.info-tag-container{display:flex;flex-wrap:wrap;gap:10px;margin-top:6px}.info-tag{background:rgba(139,92,235,0.1);border:var(--border-thin);padding:8px 14px;border-radius:var(--radius-sm);font-size:0.95rem;color:var(--text-secondary);font-weight:500;line-height:1.5}.stars-rating{display:flex;align-items:center;gap:6px;margin-top:10px}.star{color:var(--text-muted);font-size:1.3rem}.star.filled{color:var(--warning)}.star.half{position:relative;color:var(--text-muted)}.star.half::before{content:'★';position:absolute;left:0;width:50%;overflow:hidden;color:var(--warning)}.no-rating{color:var(--text-muted);font-style:italic;font-size:0.95rem}.assistidos-search-controls{display:flex;gap:20px;margin-bottom:28px;position:relative}.assistidos-search-controls .search-wrapper{flex-grow:1}#assistidos-search-input{width:100%;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);padding:16px 22px;color:var(--text-primary);font-size:1.05rem;transition:all 0.4s ease;font-family:'Poppins',sans-serif;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}#assistidos-search-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px var(--accent-glow),inset 0 2px 4px rgba(0,0,0,0.2)}#assistidos-filter-toggle-btn{height:100%;padding:0 18px;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);color:var(--text-secondary);border-radius:var(--radius-md);cursor:pointer;transition:all 0.4s ease;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 2px 4px rgba(0,0,0,0.2)}#assistidos-filter-toggle-btn:hover,#assistidos-filter-toggle-btn.active{border-color:var(--accent-primary);color:var(--text-primary);transform:translateY(-2px)}#assistidos-filter-dropdown{position:absolute;top:calc(100% + 10px);right:0;background:linear-gradient(135deg,var(--bg-tertiary),var(--bg-accent));border:var(--border-medium);border-radius:var(--radius-md);box-shadow:var(--shadow-medium);z-index:100;overflow:hidden;width:160px}#assistidos-filter-dropdown.hidden{display:none}@media (max-width:768px){.modal-content{flex-direction:column;align-items:center;text-align:center;padding:24px}.modal-poster img{width:190px}.modal-meta,.modal-genres{justify-content:center}.main-container{grid-template-columns:1fr}.top-nav{flex-direction:column;gap:12px}.sponsored-search-controls,.assistidos-search-controls{flex-direction:column}.filter-wrapper{align-self:flex-end}}@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}.card,.media-card{animation:fadeIn 0.6s ease-out}@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(139,92,235,0.4)}70%{box-shadow:0 0 0 10px rgba(139,92,235,0)}100%{box-shadow:0 0 0 0 rgba(139,92,235,0)}}.pulse{animation:pulse 2s infinite}</style></head><body><nav class="top-nav"><a class="nav-link active" data-tab="patrocinar"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z"/></svg>Patrocinar</a><a class="nav-link" data-tab="patrocinados"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM6.79 5.093A.5.5 0 0 0 6 5.5v5a.5.5 0 0 0 .79.407l3.5-2.5a.5.5 0 0 0 0-.814l-3.5-2.5z"/></svg>Patrocinados</a><a class="nav-link" data-tab="assistidos"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/><path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 1 0 0 7z"/></svg>Assistidos</a></nav><main><div id="patrocinar-tab" class="tab-content"><div class="main-container"><div class="column"><div id="search-block" class="static-card"><h2>Buscar</h2><div class="tabs"><button class="tab-button active" data-type="movie">Filme</button><button class="tab-button" data-type="tv">Série/Anime</button></div><div class="search-wrapper"><input type="text" id="search-input" placeholder="Pesquisar filme"><div id="search-results-list" class="hidden"></div></div><div id="search-preview" class="static-card hidden"></div></div><div id="config-block" class="static-card hidden"><div id="config-options"></div></div></div><div class="column"><div class="static-card"><h2>Resumo do Patrocínio</h2><div id="summary-placeholder" class="placeholder">Configure as opções para ver o preço</div><div id="summary-content" class="hidden"><div style="display:flex;gap:18px;"><img class="poster" id="summary-poster" src="" alt="Poster"><div><h3 id="summary-title"></h3><p id="summary-info" class="media-info"></p></div></div><div class="divider"></div><div id="price-breakdown"></div><div class="divider"></div><div class="total"><p class="total-text">Total:</p><p class="price" id="total-price">R$ 0,00</p></div><a id="pay-button" href="https://livepix.gg/loryez" target="_blank" class="pay-button"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/><path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/></svg>Pagar no LivePix</a><div id="restriction-warning" class="error-notice hidden" style="margin-top:20px;"></div></div></div></div><div class="info-box"><h3>Informações importantes:</h3><ul><li>Para séries e animes, é necessário patrocinar pelo menos 3 episódios</li><li>Materiais que precisarem de censura (nudez), não será possível transmiti-lo imediatamente. Data do filme a combinar com o patrocinador!</li></ul></div></div></div><div id="patrocinados-tab" class="tab-content hidden"><div class="sponsored-section"><div class="sponsored-search-controls"><div class="search-wrapper"><input type="text" id="sponsored-search-input" placeholder="Pesquisar em patrocinados..."></div><div class="filter-wrapper"><button id="filter-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.74.439L7 12.439V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2z"/></svg></button><div id="filter-dropdown" class="hidden"><a class="filter-option active" data-filter="all">Todos</a><a class="filter-option" data-filter="filmes">Filmes</a><a class="filter-option" data-filter="series">Séries</a><a class="filter-option" data-filter="animes">Animes</a></div></div></div><div id="loading-message" style="text-align:center;font-size:1.3rem;color:var(--text-muted);margin-top:60px;">Carregando conteúdos patrocinados...</div><div id="filmes-section" class="hidden"><h2>Filmes Patrocinados</h2><div id="filmes-grid" class="media-grid"></div></div><div id="series-section" class="hidden"><h2>Séries Patrocinadas</h2><div id="series-grid" class="media-grid"></div></div><div id="animes-section" class="hidden"><h2>Animes Patrocinados</h2><div id="animes-grid" class="media-grid"></div></div></div></div><div id="assistidos-tab" class="tab-content hidden"><div class="sponsored-section"><div class="assistidos-search-controls"><div class="search-wrapper"><input type="text" id="assistidos-search-input" placeholder="Pesquisar em assistidos..."></div><div class="filter-wrapper"><button id="assistidos-filter-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.74.439L7 12.439V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2z"/></svg></button><div id="assistidos-filter-dropdown" class="hidden"><a class="filter-option active" data-filter="all">Todos</a><a class="filter-option" data-filter="filmes">Filmes</a><a class="filter-option" data-filter="series">Séries</a><a class="filter-option" data-filter="animes">Animes</a></div></div></div><div id="assistidos-loading-message" style="text-align:center;font-size:1.3rem;color:var(--text-muted);margin-top:60px;">Carregando conteúdos assistidos...</div><div id="assistidos-filmes-section" class="hidden"><h2>Filmes Assistidos</h2><div id="assistidos-filmes-grid" class="media-grid"></div></div><div id="assistidos-series-section" class="hidden"><h2>Séries Assistidas</h2><div id="assistidos-series-grid" class="media-grid"></div></div><div id="assistidos-animes-section" class="hidden"><h2>Animes Assistidos</h2><div id="assistidos-animes-grid" class="media-grid"></div></div></div></div></main><div id="details-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close">&times;</button><div class="modal-poster"><img id="modal-poster" src="" alt="Pôster do conteúdo"></div><div class="modal-details"><h2 id="modal-title" class="modal-title"></h2><div id="modal-meta" class="modal-meta"></div><div id="modal-info-tv" class="hidden"><div id="modal-total-eps-group" class="modal-info-group hidden"><strong>Episódios Totais:</strong><div id="modal-total-eps" class="info-tag-container"></div></div><div class="modal-info-group"><strong>Episódios Patrocinados:</strong><div id="modal-sponsored-eps" class="info-tag-container"></div></div><div class="modal-info-group"><strong>Episódios Assistidos:</strong><div id="modal-watched-eps" class="info-tag-container"></div></div></div><div class="modal-info-group"><strong>Patrocinador:</strong><div id="modal-sponsor" class="info-tag-container"></div></div><div class="modal-info-group"><strong>Sinopse:</strong><p id="modal-synopsis"></p></div><div id="modal-genres-container" class="modal-info-group hidden"><strong>Gêneros:</strong><div id="modal-genres" class="modal-genres"></div></div></div></div></div><div id="assistidos-details-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close">&times;</button><div class="modal-poster"><img id="assistidos-modal-poster" src="" alt="Pôster do conteúdo"></div><div class="modal-details"><h2 id="assistidos-modal-title" class="modal-title"></h2><div id="assistidos-modal-meta" class="modal-meta"></div><div id="assistidos-modal-info-tv" class="hidden"><div class="modal-info-group"><strong>Episódios Patrocinados:</strong><div id="assistidos-modal-sponsored-eps" class="info-tag-container"></div></div><div class="modal-info-group"><strong>Episódios Assistidos:</strong><div id="assistidos-modal-watched-eps" class="info-tag-container"></div></div></div><div class="modal-info-group"><strong>Patrocinador:</strong><div id="assistidos-modal-sponsor" class="info-tag-container"></div></div><div class="modal-info-group"><strong>Nota da Lorena:</strong><div id="assistidos-modal-rating" class="stars-rating"></div></div><div class="modal-info-group"><strong>Sinopse:</strong><p id="assistidos-modal-synopsis"></p></div><div id="assistidos-modal-genres-container" class="modal-info-group hidden"><strong>Gêneros:</strong><div id="assistidos-modal-genres" class="modal-genres"></div></div></div></div></div><script>const API_KEY='ae110c8706fa5b6ed0a58125648e31b3';const BASE_URL='https://api.themoviedb.org/3';const IMG_URL='https://image.tmdb.org/t/p/w500';const gritoIds=["1970","465086","11838","9666","1975","382602","1977","259233","400703","103445","376788","199766","199774","36917","26693","32250","44203","347946","1192702"];const NUDEZ_DATA_URL='https://script.google.com/macros/s/AKfycbwOxm_qIqkfQl9JOOo89y7fueg1CMEj7yIwYatBAOWQf1HYUfYBehNUYbDuKpEewANaNg/exec';let nudezIds=[];const SPONSORED_DATA_URL='https://script.google.com/macros/s/AKfycbxrevz030R4hOUV9ZGz4ZRbnM5cX8CIbK5o271i2v0Ve-pKxubTNRYtSQJ3_qVkW3KR/exec';const ASSISTIDOS_DATA_URL='https://script.google.com/macros/s/AKfycbxAJoMiHQQy7WbhbWd0ukyXQp34W3zbULqOb6bwW-TfDtGrfw7-iGBoStSyIX1IVyGM6g/exec';const state={mediaType:'movie',selectedItem:null,tempItem:null,options:{season:1,episodes:3,selectedEpisodes:[],nudez:false,nudezEpisodes:0},derived:{tvType:'series',episodeCount:0,seasonEpisodes:0,seasonEpisodesData:[],hasNudez:false,ageRating:'Classificação não encontrada',ageRatingDescription:'Não foi possível determinar a classificação indicativa',discountNotice:'',warningNotice:'',productionCompanies:[],releaseDate:'',temNudezEspecial:false,isGrito:false,totalEpisodes:0,listInfo:{loading:false,sponsoredEpisodes:0,watchedEpisodes:0,currentSeasonSponsored:0,isCurrentSeasonFullySponsored:false,lastSponsoredEpisode:0,hasTemporadas:false,temporadasPatrocinadas:[],temporadasAssistidas:[],totalPatrocinados:0,totalAssistidos:0}}};const $=s=>document.querySelector(s);const $$=s=>document.querySelectorAll(s);function init(){$$('.tab-button').forEach(t=>t.addEventListener('click',selectTab));$('#search-input').addEventListener('input',handleSearchInput);fetchNudezIds()}async function fetchNudezIds(){try{const r=await fetch(NUDEZ_DATA_URL);const d=await r.json();if(Array.isArray(d)){nudezIds=d.map(i=>i["IDS DE FILMES COM NUDEZ"].toString());console.log('Lista de IDs com nudez carregada:',nudezIds.length,'itens')}}catch(e){console.error('Erro ao buscar lista de nudez:',e);nudezIds=[]}}function selectTab(e){$$('.tab-button').forEach(t=>t.classList.remove('active'));e.target.classList.add('active');state.mediaType=e.target.dataset.type;$('#search-input').placeholder=state.mediaType==='movie'?'Pesquisar filme':'Pesquisar série ou anime';resetToSearch()}let searchTimeout;function handleSearchInput(){clearTimeout(searchTimeout);$('#search-preview').classList.add('hidden');const q=$('#search-input').value.trim();if(q.length>2){searchTimeout=setTimeout(()=>searchMedia(q),300)}else{$('#search-results-list').classList.add('hidden')}}async function searchMedia(q){const e=`${BASE_URL}/search/${state.mediaType}?api_key=${API_KEY}&query=${encodeURIComponent(q)}&language=pt-BR&include_adult=false`;const r=await fetch(e);const d=await r.json();renderSearchResults(d.results)}function renderSearchResults(r){const l=$('#search-results-list');l.innerHTML='';if(r&&r.length>0){r.forEach(i=>{const d=document.createElement('div');d.className='search-result-item';const t=i.title||i.name;const y=(i.release_date||i.first_air_date)?.split('-')[0]||'';d.innerHTML=`<img src="${i.poster_path?IMG_URL+i.poster_path:'https://via.placeholder.com/45x65/333333/ffffff?text=No+Image'}" alt="poster"><div><p>${t}</p><span>${y}</span></div>`;d.addEventListener('click',()=>showPreview(i));l.appendChild(d)});l.classList.remove('hidden')}else{l.classList.add('hidden')}}function showPreview(i){state.tempItem=i;$('#search-results-list').classList.add('hidden');const t=i.title||i.name;const y=(i.release_date||i.first_air_date)?.split('-')[0]||'';$('#search-preview').innerHTML=`<div class="preview-content"><img src="${i.poster_path?IMG_URL+i.poster_path:'https://via.placeholder.com/190x285/333333/ffffff?text=No+Image'}" class="poster"><div><h3>${t}</h3><p class="media-info">${y}</p><p class="synopsis">${i.overview||'Sinopse não disponível.'}</p></div></div><button class="continue-button"><div class="spinner"></div><span class="button-text">Continuar</span></button>`;$('#search-preview').classList.remove('hidden');$('#search-preview .continue-button').addEventListener('click',async(e)=>{const b=e.currentTarget;b.classList.add('is-loading');b.disabled=true;try{await selectItem(i.id)}catch(er){console.error("Erro ao selecionar o item:",er);b.classList.remove('is-loading');b.disabled=false}})}async function selectItem(id){state.options={season:1,episodes:3,selectedEpisodes:[],nudez:false,nudezEpisodes:0};const e=`${BASE_URL}/${state.mediaType}/${id}?api_key=${API_KEY}&language=pt-BR`;const r=await fetch(e);state.selectedItem=await r.json();if(state.mediaType==='tv'){state.derived.totalEpisodes=state.selectedItem.number_of_episodes||0}if(state.selectedItem.id===325789)state.selectedItem.runtime=126;if(state.selectedItem.id===15003)state.selectedItem.runtime=93;state.derived.isGrito=gritoIds.includes(state.selectedItem.id.toString());state.derived.temNudezEspecial=!state.derived.isGrito&&nudezIds.includes(state.selectedItem.id.toString());await fetchContentRating();if(state.mediaType==='tv'){const isAnim=state.selectedItem.genres.some(g=>g.id===16);state.derived.tvType=isAnim?'anime':'series';await fetchSeasonDetails()}state.derived.hasNudez=!state.derived.isGrito&&(state.selectedItem.adult||false);getProductionInfo();await fetchSponsoredData();switchToConfigView();renderConfigOptions();calculatePrice()}async function fetchSponsoredData(){state.derived.listInfo.loading=true;state.derived.listInfo.sponsoredEpisodes=0;state.derived.listInfo.watchedEpisodes=0;state.derived.listInfo.currentSeasonSponsored=0;state.derived.listInfo.isCurrentSeasonFullySponsored=false;state.derived.listInfo.lastSponsoredEpisode=0;state.derived.listInfo.hasTemporadas=false;state.derived.listInfo.temporadasPatrocinadas=[];state.derived.listInfo.temporadasAssistidas=[];state.derived.listInfo.totalPatrocinados=0;state.derived.listInfo.totalAssistidos=0;const id=state.selectedItem.id.toString();const title=state.selectedItem.title||state.selectedItem.name;try{const r=await fetch(SPONSORED_DATA_URL);const d=await r.json();if(d&&Array.isArray(d)){const item=d.find(i=>i["ID DO TMDB"]===parseInt(id)||normalizeTitle(i.Titulo)===normalizeTitle(title));if(item){processSponsoredData(item)}}}catch(e){console.error('Erro ao buscar dados de patrocínio:',e)}finally{state.derived.listInfo.loading=false}}function processSponsoredData(i){if(i["Episódios Patrocinados"]){const s=i["Episódios Patrocinados"];if(typeof s==='number'){state.derived.listInfo.sponsoredEpisodes=s;state.derived.listInfo.totalPatrocinados=s}else if(typeof s==='string'){const t=extractTemporadasFromDescription(s);if(t.length>0){state.derived.listInfo.hasTemporadas=true;state.derived.listInfo.temporadasPatrocinadas=t;state.derived.listInfo.totalPatrocinados=t.reduce((sum,temp)=>sum+temp.episodios,0)}else{const n=extractEpisodeCount(s);if(n){state.derived.listInfo.sponsoredEpisodes=n;state.derived.listInfo.totalPatrocinados=n}}}}if(i["Episódios Assistidos"]){const w=i["Episódios Assistidos"];if(typeof w==='number'){state.derived.listInfo.watchedEpisodes=w;state.derived.listInfo.totalAssistidos=w}else if(typeof w==='string'){const t=extractTemporadasFromDescription(w);if(t.length>0){state.derived.listInfo.hasTemporadas=true;state.derived.listInfo.temporadasAssistidas=t;state.derived.listInfo.totalAssistidos=t.reduce((sum,temp)=>sum+temp.episodios,0)}else{const n=extractEpisodeCount(w);if(n){state.derived.listInfo.watchedEpisodes=n;state.derived.listInfo.totalAssistidos=n}}}}if(!state.derived.listInfo.hasTemporadas){if(state.derived.listInfo.sponsoredEpisodes>0){state.derived.listInfo.totalPatrocinados=state.derived.listInfo.sponsoredEpisodes}if(state.derived.listInfo.watchedEpisodes>0){state.derived.listInfo.totalAssistidos=state.derived.listInfo.watchedEpisodes}}}function extractTemporadasFromDescription(d){if(!d)return[];const map={};const nums={'primeira':1,'segunda':2,'terceira':3,'quarta':4,'quinta':5,'sexta':6,'sétima':7,'oitava':8,'nona':9,'décima':10};const parts=d.split(' - ');parts.forEach(p=>{const r1=/(\d+)\s*\(?\s*(\d+)[ª°].*?(?:temporada|temp)/gi;let m1;while((m1=r1.exec(p))!==null){const e=parseInt(m1[1]);const t=parseInt(m1[2]);map[t]=e}const r2=/(\d+)\s*da\s*(Primeira|Segunda|Terceira|Quarta|Quinta|Sexta|Sétima|Oitava|Nona|Décima)\s*Temporada/gi;let m2;while((m2=r2.exec(p))!==null){const e=parseInt(m2[1]);const te=m2[2].toLowerCase();const t=nums[te];if(t)map[t]=e}});const t=Object.keys(map).map(tn=>({temporada:parseInt(tn),episodios:map[tn]}));return t.sort((a,b)=>a.temporada-b.temporada)}function extractEpisodeCount(d){if(!d)return null;const p=[/(\d+)\s*epis[oó]dios?/i,/(\d+)\s*eps?/i,/patrocinou\s*(\d+)/i,/assistiu\s*(\d+)/i];for(const pat of p){const m=d.match(pat);if(m&&m[1])return parseInt(m[1])}return null}function normalizeTitle(t){return t.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9 ]/g,'').replace(/\s+/g,' ').trim()}function getProductionInfo(){state.derived.productionCompanies=[];if(state.selectedItem.production_companies){state.derived.productionCompanies=state.selectedItem.production_companies.map(c=>c.name)}if(state.selectedItem.release_date){state.derived.releaseDate=new Date(state.selectedItem.release_date).toLocaleDateString('pt-BR')}else if(state.selectedItem.first_air_date){state.derived.releaseDate=new Date(state.selectedItem.first_air_date).toLocaleDateString('pt-BR')}else{state.derived.releaseDate='Data não disponível'}}async function fetchContentRating(){let e;if(state.mediaType==='movie'){e=`${BASE_URL}/movie/${state.selectedItem.id}/release_dates?api_key=${API_KEY}`}else{e=`${BASE_URL}/tv/${state.selectedItem.id}/content_ratings?api_key=${API_KEY}`}try{const r=await fetch(e);const d=await r.json();let f=false;if(state.mediaType==='movie'){const b=d.results.find(r=>r.iso_3166_1==='BR');if(b&&b.release_dates.length>0&&b.release_dates[0].certification){state.derived.ageRating=b.release_dates[0].certification;f=true}}else{const b=d.results.find(r=>r.iso_3166_1==='BR');if(b&&b.rating){state.derived.ageRating=b.rating;f=true}}if(!f){let u='';if(state.mediaType==='movie'){const ur=d.results.find(r=>r.iso_3166_1==='US');if(ur&&ur.release_dates.length>0&&ur.release_dates[0].certification){u=ur.release_dates[0].certification}}else{const ur=d.results.find(r=>r.iso_3166_1==='US');if(ur&&ur.rating){u=ur.rating}}if(u){state.derived.ageRating=convertForeignRatingToBR(u);f=true}}if(!f){for(const cr of d.results){if(cr.iso_3166_1==='BR'||cr.iso_3166_1==='US')continue;let fr='';if(state.mediaType==='movie'){if(cr.release_dates&&cr.release_dates.length>0){const c=cr.release_dates.find(rd=>rd.certification)?.certification;if(c)fr=c}}else{if(cr.rating)fr=cr.rating}if(fr){const crt=convertForeignRatingToBR(fr);if(crt!=='Classificação não encontrada'){state.derived.ageRating=crt;f=true;break}}}}if(!f){state.derived.ageRating='Classificação não encontrada';state.derived.ageRatingDescription='Não foi possível determinar a classificação indicativa';return}switch(state.derived.ageRating){case'L':state.derived.ageRatingDescription='Livre para todos os públicos';break;case'10':state.derived.ageRatingDescription='Não recomendado para menores de 10 anos';break;case'12':state.derived.ageRatingDescription='Não recomendado para menores de 12 anos';break;case'14':state.derived.ageRatingDescription='Não recomendado para menores de 14 anos';break;case'16':state.derived.ageRatingDescription='Não recomendado para menores de 16 anos';break;case'18':state.derived.ageRatingDescription='Não recomendado para menores de 18 anos';break;default:state.derived.ageRatingDescription='Classificação indicativa não encontrada'}}catch(er){console.error('Erro ao buscar classificação:',er);state.derived.ageRating='Classificação não encontrada';state.derived.ageRatingDescription='Não foi possível determinar a classificação indicativa'}}function convertForeignRatingToBR(f){const m={'G':'L','PG':'10','PG-13':'12','R':'16','NC-17':'18','TV-Y':'L','TV-Y7':'10','TV-G':'L','TV-PG':'10','TV-14':'14','TV-MA':'18','U':'L','12A':'12','15':'16','0':'L','6':'10','12':'12','16':'16','18':'18','Tous publics':'L','-10':'10','-12':'12','-16':'16','-18':'18','G':'L','PG12':'12','R15+':'16','R18+':'18','M':'14','MA15+':'16','R18+':'18','X18+':'18','14A':'14','18A':'18','APTA':'L','7':'10','All':'L','19':'18'};return m[f]||'Classificação não encontrada'}async function fetchSeasonDetails(){const e=`${BASE_URL}/tv/${state.selectedItem.id}/season/${state.options.season}?api_key=${API_KEY}&language=pt-BR`;const r=await fetch(e);const d=await r.json();state.derived.seasonEpisodesData=d.episodes||[];calculateCurrentSeasonSponsored();markSponsoredEpisodes();autoSelectNextEpisodes();if(state.derived.tvType==='anime'){updateAndApplyFreeEpisodes()}}function calculateCurrentSeasonSponsored(){const total=state.derived.listInfo.hasTemporadas?state.derived.listInfo.totalPatrocinados:state.derived.listInfo.sponsoredEpisodes;if(total>0&&state.mediaType==='tv'){const current=state.options.season;let prev=0;for(let i=1;i<current;i++){const ps=state.selectedItem.seasons.find(s=>s.season_number===i);if(ps)prev+=ps.episode_count}const currCount=state.derived.seasonEpisodesData.length;const rem=total-prev;state.derived.listInfo.currentSeasonSponsored=Math.max(0,Math.min(currCount,rem));state.derived.listInfo.isCurrentSeasonFullySponsored=state.derived.listInfo.currentSeasonSponsored>=currCount;state.derived.listInfo.lastSponsoredEpisode=prev+state.derived.listInfo.currentSeasonSponsored}else{state.derived.listInfo.currentSeasonSponsored=0;state.derived.listInfo.isCurrentSeasonFullySponsored=false;state.derived.listInfo.lastSponsoredEpisode=0}}function markSponsoredEpisodes(){if(state.derived.listInfo.currentSeasonSponsored>0&&state.mediaType==='tv'){const c=state.derived.listInfo.currentSeasonSponsored;state.derived.seasonEpisodesData.forEach((e,i)=>{if(i<c){const ex=state.options.selectedEpisodes.findIndex(ep=>ep.id===e.id);if(ex===-1){state.options.selectedEpisodes.push({id:e.id,number:e.episode_number,duration:e.runtime||0,isFree:false,addedAutomatically:true,alreadySponsored:true})}else{state.options.selectedEpisodes[ex].alreadySponsored=true}}})}}function autoSelectNextEpisodes(){if(state.mediaType==='tv'&&!state.derived.listInfo.isCurrentSeasonFullySponsored){const toSel=3;let cnt=0;const start=state.derived.listInfo.currentSeasonSponsored;for(let i=start;i<state.derived.seasonEpisodesData.length&&cnt<toSel;i++){const ep=state.derived.seasonEpisodesData[i];const isSel=state.options.selectedEpisodes.some(e=>e.id===ep.id);if(!isSel){state.options.selectedEpisodes.push({id:ep.id,number:ep.episode_number,duration:ep.runtime||0,isFree:false,addedAutomatically:true,alreadySponsored:false});cnt++}}}state.options.episodes=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length}function renderConfigOptions(){const sep=" ‧ ";const year=(state.selectedItem.release_date||state.selectedItem.first_air_date)?.split('-')[0]||'N/A';const minfo=`Filme ${sep} ${year} ${sep} ${formatDuration(state.selectedItem.runtime)}`;const tinfo=`${state.derived.tvType==='anime'?'Anime':'Série'} ${sep} ${year}`;let h=`<div style="display:flex;justify-content:space-between;align-items:center;"><h2>Item Selecionado</h2><button class="change-button" id="change-item">Alterar</button></div><div style="display:flex;gap:18px;margin-bottom:28px;"><img src="${state.selectedItem.poster_path?IMG_URL+state.selectedItem.poster_path:'https://via.placeholder.com/90x135/333333/ffffff?text=No+Image'}" class="poster" style="width:90px;height:135px;"><div><h3>${state.selectedItem.title||state.selectedItem.name}</h3><p class="media-info">${state.mediaType==='movie'?minfo:tinfo}</p></div></div>`;if(state.mediaType==='tv'&&state.derived.listInfo.isCurrentSeasonFullySponsored){h+=`<div class="sponsored-message"><strong>Esta temporada já foi patrocinada, selecione outra (se disponível) para ver os preços.</strong></div>`}h+=`<div class="classificacao-box"><p><strong>Classificação Indicativa</strong></p><p><strong>${state.derived.ageRating}</strong> - ${state.derived.ageRatingDescription}</p>`;if(state.derived.temNudezEspecial){h+=`<div class="nudez-warning">Este filme contém nudez</div>`}else if(!state.derived.isGrito&&((state.mediaType==='movie'&&parseInt(state.derived.ageRating)>=14)||(state.mediaType==='tv'&&state.derived.tvType==='series'&&parseInt(state.derived.ageRating)>=16))){h+=`<span>⚠ Pode conter nudez. Considere aplicar a taxa de nudez abaixo.</span>`}h+=`</div>`;if(state.derived.isGrito){h+=`<div class="grito-notice" style="margin-top:20px;">Conteúdo da franquia "O Grito" - Preço fixo de R$ 15.000,00. Taxas não se aplicam.</div>`}h+=`<div class="info-content"><h4>Informações do Conteúdo</h4><div class="divider"></div><div class="studio-list"><strong>Estúdios detectados:</strong><br>${state.derived.productionCompanies.length>0?state.derived.productionCompanies.join(', '):'Não disponível'}</div><div class="divider"></div><div class="release-info"><strong>Lançado em:</strong> ${state.derived.releaseDate}</div></div>`;if(state.mediaType==='tv'){const s=state.selectedItem.seasons.filter(ss=>ss.season_number>0&&ss.episode_count>0);const sh=s.map(ss=>`<option value="${ss.season_number}" data-episodes="${ss.episode_count}">${ss.name} (${ss.episode_count} eps)</option>`).join('');h+=`<div class="config-group"><h3>Temporada</h3><select id="season-select" class="select-input">${sh}</select></div>`;h+=`<div class="config-group"><h3>Selecionar Episódios</h3><div class="episode-selector"><p style="margin-bottom:14px;font-size:0.95rem;color:var(--text-secondary);">Selecione os episódios que deseja patrocinar (mínimo 3):</p><div class="episode-scroll-container" id="episodes-list"></div></div><div class="discount-notice ${state.derived.discountNotice?'':'hidden'}" style="margin-top:20px;">${state.derived.discountNotice}</div></div>`}if(!state.derived.isGrito){h+=`<div class="config-group checkbox-group" style="margin-top:28px;"><h3 style="margin-top:20px;">Conteúdo de Risco</h3>`;if(state.derived.temNudezEspecial){state.options.nudez=true;h+=`<label><input type="checkbox" data-option="nudez" checked disabled class="nudez-checkbox"> Contém Nudez (automático)</label>`;h+=`<div class="nudez-warning" style="margin-top:14px;">Este filme foi identificado como contendo nudez. A taxa será aplicada automaticamente.</div>`}else{if(state.mediaType==='movie'){h+=`<label><input type="checkbox" data-option="nudez" ${state.options.nudez?'checked':''} class="nudez-checkbox"> Contém Nudez (+R$ 15)</label>`}else{h+=`<label><input type="checkbox" data-option="nudez" ${state.options.nudez?'checked':''} class="nudez-checkbox"> Contém Nudez (+R$ 10 POR EP C/ NUDEZ)</label>`}}h+=`</div>`;if(state.mediaType==='tv'&&state.options.nudez){h+=`<div class="nudez-episodes-config"><h3>Quantos episódios contêm nudez?</h3><div class="number-input-wrapper"><button class="num-btn" data-action="dec-nudez">-</button><input type="number" id="nudez-episodes-count" value="${state.options.nudezEpisodes}" min="0" max="${state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length}"><button class="num-btn" data-action="inc-nudez">+</button></div></div>`}}$('#config-options').innerHTML=h;if(state.mediaType==='tv'){renderEpisodesList()}$('#change-item').addEventListener('click',resetToSearch);if(state.mediaType==='tv'){$('#season-select').addEventListener('change',handleSeasonChange);if(!state.derived.isGrito&&$('#nudez-episodes-count')){$('#nudez-episodes-count').addEventListener('input',handleNudezEpisodeInput);$$('[data-action="inc-nudez"], [data-action="dec-nudez"]').forEach(b=>{b.addEventListener('click',handleNudezEpisodeBtn)})}handleSeasonChange()}if(!state.derived.isGrito){$$('.checkbox-group input').forEach(cb=>{if(!cb.disabled){cb.addEventListener('change',handleCheckbox)}})}}function renderEpisodesList(){const l=$('#episodes-list');l.innerHTML='';const map=new Map(state.options.selectedEpisodes.map(ep=>[ep.id,ep]));state.derived.seasonEpisodesData.forEach(e=>{const sel=map.get(e.id);const isSel=!!sel;const isFree=isSel&&sel.isFree;const isSpon=isSel&&sel.alreadySponsored;const d=document.createElement('div');d.className='episode-item';const fl=isFree?` <span style="color: var(--success); font-weight: 500;">(Grátis)</span>`:'';const sl=isSpon?` <span class="already-sponsored">(Já patrocinado)</span>`:'';const dis=isFree||isSpon?'disabled':'';d.innerHTML=`<input type="checkbox" class="episode-checkbox" data-episode-id="${e.id}" data-episode-number="${e.episode_number}" data-episode-duration="${e.runtime||0}" ${isSel?'checked':''} ${dis}><div class="episode-info">Episódio ${e.episode_number}: ${e.name||'Sem título'}${fl}${sl}</div><div class="episode-duration">${formatDuration(e.runtime)}</div>`;if(!isSpon){d.querySelector('.episode-checkbox').addEventListener('change',handleEpisodeSelection)}l.appendChild(d)})}function updateAndApplyFreeEpisodes(){if(state.derived.tvType!=='anime')return;const paid=state.options.selectedEpisodes.filter(ep=>!ep.isFree&&!ep.alreadySponsored);const deserved=Math.floor(paid.length/11);const current=state.options.selectedEpisodes.filter(ep=>ep.isFree&&!ep.alreadySponsored);if(current.length>deserved){const rem=current.slice(deserved);rem.forEach(ep=>{state.options.selectedEpisodes=state.options.selectedEpisodes.filter(e=>e.id!==ep.id)})}if(deserved>current.length){const toAdd=deserved-current.length;let added=0;const nums=paid.map(ep=>ep.number).sort((a,b)=>a-b);const last=nums[nums.length-1]||0;for(let i=last+1;i<=state.derived.seasonEpisodesData.length&&added<toAdd;i++){const cand=state.derived.seasonEpisodesData.find(ep=>ep.episode_number===i);if(cand){const exists=state.options.selectedEpisodes.some(ep=>ep.id===cand.id);if(!exists){state.options.selectedEpisodes.push({id:cand.id,number:cand.episode_number,duration:cand.runtime||0,isFree:true,addedAutomatically:true,alreadySponsored:false});added++}}}}}function handleEpisodeSelection(e){const cb=e.target;const id=parseInt(cb.dataset.episodeId);const num=parseInt(cb.dataset.episodeNumber);const dur=parseInt(cb.dataset.episodeDuration);const curr=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored);const will=cb.checked;if(!will){const fut=curr.filter(ep=>ep.id!==id);if(fut.length<3){cb.checked=true;alert('É necessário selecionar pelo menos 3 episódios.');return}}if(cb.checked){state.options.selectedEpisodes.push({id:id,number:num,duration:dur,isFree:false,addedAutomatically:false,alreadySponsored:false})}else{state.options.selectedEpisodes=state.options.selectedEpisodes.filter(ep=>ep.id!==id)}if(state.derived.tvType==='anime'){updateAndApplyFreeEpisodes()}state.options.episodes=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length;if(!state.derived.isGrito&&$('#nudez-episodes-count')){$('#nudez-episodes-count').max=state.options.episodes;if(state.options.nudezEpisodes>state.options.episodes){state.options.nudezEpisodes=state.options.episodes;$('#nudez-episodes-count').value=state.options.episodes}}renderEpisodesList();checkDiscounts();calculatePrice()}async function handleSeasonChange(){const s=$('#season-select');const op=s.options[s.selectedIndex];const sn=parseInt(s.value);state.options.season=sn;state.derived.seasonEpisodes=parseInt(op.dataset.episodes);state.options.selectedEpisodes=[];state.options.nudezEpisodes=0;await fetchSeasonDetails();state.options.episodes=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length;renderEpisodesList();checkDiscounts();calculatePrice()}function handleNudezEpisodeBtn(e){const i=$('#nudez-episodes-count');let v=parseInt(i.value);v+=e.target.dataset.action==='inc-nudez'?1:-1;if(v<0)v=0;if(v>state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length){v=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length}i.value=v;state.options.nudezEpisodes=v;calculatePrice()}function handleNudezEpisodeInput(){const i=$('#nudez-episodes-count');let v=parseInt(i.value)||0;const max=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length;if(v<0)v=0;if(v>max)v=max;i.value=v;state.options.nudezEpisodes=v;calculatePrice()}function checkDiscounts(){if(state.derived.isGrito){state.derived.discountNotice='';return}state.derived.discountNotice='';if(state.mediaType==='tv'){if(state.derived.tvType==='series'&&state.derived.listInfo.currentSeasonSponsored===0&&state.options.episodes===state.derived.seasonEpisodes){state.derived.discountNotice='🎉 15% de desconto pela temporada completa!'}if(state.derived.tvType==='anime'){const f=state.options.selectedEpisodes.filter(ep=>ep.isFree).length;if(f>0){state.derived.discountNotice=`🎉 Você ganhou ${f} episódio(s) grátis!`}}}const el=document.querySelector('.discount-notice');if(el){if(state.derived.discountNotice){el.textContent=state.derived.discountNotice;el.classList.remove('hidden')}else{el.classList.add('hidden')}}}function handleCheckbox(e){const o=e.target.dataset.option;state.options[o]=e.target.checked;if(o==='nudez'&&!e.target.checked){state.options.nudezEpisodes=0}if(o==='nudez'){updateNudezSection()}else{renderConfigOptions()}calculatePrice()}function updateNudezSection(){if(state.mediaType==='tv'&&state.options.nudez){const h=`<div class="nudez-episodes-config"><h3>Quantos episódios contêm nudez?</h3><div class="number-input-wrapper"><button class="num-btn" data-action="dec-nudez">-</button><input type="number" id="nudez-episodes-count" value="${state.options.nudezEpisodes}" min="0" max="${state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored).length}"><button class="num-btn" data-action="inc-nudez">+</button></div></div>`;const sec=document.querySelector('.nudez-episodes-config');if(sec){sec.outerHTML=h}else{const cb=document.querySelector('.checkbox-group');cb.insertAdjacentHTML('afterend',h)}if($('#nudez-episodes-count')){$('#nudez-episodes-count').addEventListener('input',handleNudezEpisodeInput);$$('[data-action="inc-nudez"], [data-action="dec-nudez"]').forEach(b=>{b.addEventListener('click',handleNudezEpisodeBtn)})}}else{const sec=document.querySelector('.nudez-episodes-config');if(sec){sec.remove()}}}function formatDuration(m){if(!m||m===0)return'Duração não disponível';const h=Math.floor(m/60);const mn=m%60;return h>0?`${h}h ${mn}m`:`${mn}m`}function calculatePrice(){let t=0;let h='';const f=v=>`R$ ${v.toFixed(2).replace('.',',')}`;const mb=80;const ss=20;const sl=40;const sa=15;const nm=15;const ne=10;const em=0.50;const nonSpon=state.options.selectedEpisodes.filter(ep=>!ep.alreadySponsored);const hasNon=nonSpon.length>0;if(state.derived.isGrito){t=15000;h+=`<p><span>Preço fixo: Franquia O Grito</span><span>${f(t)}</span></p>`}else if(state.mediaType==='movie'){t+=mb;h+=`<p><span>Filme (até 2h)</span><span>${f(mb)}</span></p>`;const r=state.selectedItem.runtime||0;if(r>120){const ex=r-120;const ec=ex*em;t+=ec;h+=`<p><span>${ex} minutos extras (1min = R$0,50)</span><span>+${f(ec)}</span></p>`}}else{let bc=0;const sort=[...nonSpon].sort((a,b)=>a.number-b.number);sort.forEach(e=>{if(e.isFree&&state.derived.tvType==='anime'){h+=`<p><span>Ep ${e.number} (${formatDuration(e.duration)})</span><span>Grátis</span></p>`;return}const ed=e.duration||0;let p;if(state.derived.tvType==='anime'){p=ed<=30?sa:sl}else{p=ed<=30?ss:sl}let ex=0;if(ed>60){ex=ed-60}const ec=ex*em;const epc=p+ec;bc+=epc;h+=`<p><span>Ep ${e.number} (${formatDuration(ed)})</span><span>${f(epc)}</span></p>`});t+=bc;if(state.derived.tvType==='series'&&state.derived.listInfo.currentSeasonSponsored===0&&state.options.episodes===state.derived.seasonEpisodes){const d=t*0.15;t-=d;h+=`<p><span>Desconto Temporada Completa</span><span>-${f(d)}</span></p>`}}if(!state.derived.isGrito&&(state.derived.temNudezEspecial||state.options.nudez)){if(state.mediaType==='movie'){t+=nm;h+=`<p><span>Taxa de nudez (filme)</span><span>+${f(nm)}</span></p>`}else{const nc=state.options.nudezEpisodes*ne;t+=nc;h+=`<p><span>Taxa de nudez (${state.options.nudezEpisodes} ep(s))</span><span>+${f(nc)}</span></p>`}}const i=state.selectedItem;const sep=" ‧ ";$('#summary-poster').src=i.poster_path?IMG_URL+i.poster_path:'https://via.placeholder.com/90x135/333333/ffffff?text=No+Image';$('#summary-title').textContent=i.title||i.name;if(state.mediaType==='movie'){$('#summary-info').textContent=`Filme ${sep} ${(i.release_date||'').split('-')[0]||'N/A'} ${sep} ${formatDuration(i.runtime)}`}else{$('#summary-info').textContent=`${state.derived.tvType==='anime'?'Anime':'Série'} ${sep} ${(i.first_air_date||'').split('-')[0]||'N/A'} ${sep} ${state.options.episodes} episódios selecionados`}$('#price-breakdown').innerHTML=h;$('#total-price').textContent=f(t);const w=$('#restriction-warning');const b=$('#pay-button');if(state.mediaType==='tv'&&state.derived.listInfo.isCurrentSeasonFullySponsored){b.classList.add('disabled');b.removeAttribute('href');w.textContent=`Esta temporada já foi patrocinada, selecione outra (se disponível) para ver os preços.`;w.classList.remove('hidden')}else if(state.mediaType==='tv'&&!hasNon){b.classList.add('disabled');b.removeAttribute('href');w.textContent=`Não há episódios disponíveis para patrocínio nesta temporada.`;w.classList.remove('hidden')}else{b.classList.remove('disabled');b.href=`https://livepix.gg/loryez?amount=${t.toFixed(2)}`;w.classList.add('hidden')}}function switchToConfigView(){$('#search-block').classList.add('hidden');$('#config-block').classList.remove('hidden');$('#summary-placeholder').classList.add('hidden');$('#summary-content').classList.remove('hidden')}function resetToSearch(){$('#search-input').value='';$('#search-results-list').classList.add('hidden');$('#search-results-list').innerHTML='';$('#search-preview').classList.add('hidden');$('#search-preview').innerHTML='';$('#search-block').classList.remove('hidden');$('#config-block').classList.add('hidden');$('#summary-placeholder').classList.remove('hidden');$('#summary-content').classList.add('hidden');state.derived.discountNotice='';state.options={season:1,episodes:3,selectedEpisodes:[],nudez:false,nudezEpisodes:0};state.derived.listInfo={loading:false,sponsoredEpisodes:0,watchedEpisodes:0,currentSeasonSponsored:0,isCurrentSeasonFullySponsored:false,lastSponsoredEpisode:0,hasTemporadas:false,temporadasPatrocinadas:[],temporadasAssistidas:[],totalPatrocinados:0,totalAssistidos:0}}(function(){function switchTab(n){document.querySelectorAll('.nav-link').forEach(l=>{l.classList.toggle('active',l.dataset.tab===n)});document.querySelectorAll('.tab-content').forEach(c=>{c.classList.toggle('hidden',c.id!==`${n}-tab`)})}document.querySelectorAll('.nav-link').forEach(l=>{l.addEventListener('click',(e)=>{e.preventDefault();switchTab(l.dataset.tab)})});const asi=document.getElementById('assistidos-search-input');const afb=document.getElementById('assistidos-filter-toggle-btn');const afd=document.getElementById('assistidos-filter-dropdown');const afo=document.querySelectorAll('#assistidos-filter-dropdown .filter-option');let caf='all';function applyAssistidosFilter(){const q=asi.value.toLowerCase().trim();document.querySelectorAll('#assistidos-tab .media-card').forEach(c=>{const t=c.querySelector('.media-card-title').textContent.toLowerCase();const tp=c.dataset.type;const mq=t.includes(q);const mf=(caf==='all'||caf===tp);c.style.display=(mq&&mf)?'block':'none'});const s={filmes:document.getElementById('assistidos-filmes-section'),series:document.getElementById('assistidos-series-section'),animes:document.getElementById('assistidos-animes-section')};Object.entries(s).forEach(([k,sec])=>{if(caf==='all'||caf===k){const v=Array.from(sec.querySelectorAll('.media-card')).some(c=>c.style.display!=='none');sec.classList.toggle('hidden',!v)}else{sec.classList.add('hidden')}})}asi.addEventListener('input',applyAssistidosFilter);afb.addEventListener('click',(e)=>{e.stopPropagation();afd.classList.toggle('hidden');afb.classList.toggle('active')});document.addEventListener('click',()=>{afd.classList.add('hidden');afb.classList.remove('active')});afo.forEach(o=>{o.addEventListener('click',(e)=>{e.preventDefault();e.stopPropagation();afo.forEach(op=>op.classList.remove('active'));e.currentTarget.classList.add('active');caf=e.currentTarget.dataset.filter;afd.classList.add('hidden');afb.classList.remove('active');applyAssistidosFilter()})});const ssi=document.getElementById('sponsored-search-input');const ftb=document.getElementById('filter-toggle-btn');const fd=document.getElementById('filter-dropdown');const fo=document.querySelectorAll('#filter-dropdown .filter-option');let cf='all';function applySponsoredFilter(){const q=ssi.value.toLowerCase().trim();document.querySelectorAll('#patrocinados-tab .media-card').forEach(c=>{const t=c.querySelector('.media-card-title').textContent.toLowerCase();const tp=c.dataset.type;const mq=t.includes(q);const mf=(cf==='all'||cf===tp);c.style.display=(mq&&mf)?'block':'none'});const s={filmes:document.getElementById('filmes-section'),series:document.getElementById('series-section'),animes:document.getElementById('animes-section')};Object.entries(s).forEach(([k,sec])=>{if(cf==='all'||cf===k){const v=Array.from(sec.querySelectorAll('.media-card')).some(c=>c.style.display!=='none');sec.classList.toggle('hidden',!v)}else{sec.classList.add('hidden')}})}ssi.addEventListener('input',applySponsoredFilter);ftb.addEventListener('click',(e)=>{e.stopPropagation();fd.classList.toggle('hidden');ftb.classList.toggle('active')});document.addEventListener('click',()=>{fd.classList.add('hidden');ftb.classList.remove('active')});fo.forEach(o=>{o.addEventListener('click',(e)=>{e.preventDefault();e.stopPropagation();fo.forEach(op=>op.classList.remove('active'));e.currentTarget.classList.add('active');cf=e.currentTarget.dataset.filter;fd.classList.add('hidden');ftb.classList.remove('active');applySponsoredFilter()})})})();(function(){const TMDB_API_KEY='ae110c8706fa5b6ed0a58125648e31b3';const TMDB_BASE_URL='https://api.themoviedb.org/3';const TMDB_IMG_URL='https://image.tmdb.org/t/p/w500';let sdc=[];let adc=[];let isl=false;let ial=false;document.querySelectorAll('.modal-overlay').forEach(m=>{m.addEventListener('click',(e)=>{if(e.target===m){m.classList.remove('visible')}})});document.querySelectorAll('.modal-close').forEach(b=>{b.addEventListener('click',function(){this.closest('.modal-overlay').classList.remove('visible')})});function renderStars(r){if(!r||r===''){return'<span class="no-rating">Sem avaliação</span>'}const n=parseFloat(r);if(isNaN(n)){return'<span class="no-rating">Sem avaliação</span>'}const f=Math.floor(n);const h=n%1>=0.5;const e=5-f-(h?1:0);let s='';for(let i=0;i<f;i++){s+='<span class="star filled">★</span>'}if(h){s+='<span class="star half">★</span>'}for(let i=0;i<e;i++){s+='<span class="star">★</span>'}return s}function populateInfoTags(id,ds){const c=document.getElementById(id);c.innerHTML='';if(ds&&ds.toString().trim()!==""){const p=ds.toString().split('|');p.forEach(pt=>{if(pt.trim()!==""){const t=document.createElement('span');t.className='info-tag';t.textContent=pt.trim();c.appendChild(t)}})}else{const t=document.createElement('span');t.className='info-tag';t.textContent='N/A';c.appendChild(t)}}async function loadSponsoredContent(){try{const r=await fetch(SPONSORED_DATA_URL);if(!r.ok)throw new Error('Falha ao buscar dados do Google Script.');const i=await r.json();const di=await Promise.all(i.map(async(it)=>{const id=it['ID DO TMDB'];if(!id)return null;const m=!it['Episódios Patrocinados']&&!it['Episódios Assistidos'];const mt=m?'movie':'tv';const u=`${TMDB_BASE_URL}/${mt}/${id}?api_key=${TMDB_API_KEY}&language=pt-BR`;const tr=await fetch(u);if(!tr.ok)return null;const td=await tr.json();return{...it,...td,media_type_custom:mt}}));document.getElementById('loading-message').classList.add('hidden');renderSponsoredContent(di.filter(it=>it!==null))}catch(e){console.error('Erro ao carregar conteúdo patrocinado:',e);const l=document.getElementById('loading-message');l.innerHTML=`<div class="error-notice" style="margin-bottom:20px;text-align:left;">Erro ao carregar os dados. Tente novamente mais tarde.</div><button id="retry-sponsored" class="change-button" style="background:var(--accent-primary);color:var(--text-primary);border-color:var(--accent-primary);">Tentar Novamente</button>`;l.querySelector('#retry-sponsored').addEventListener('click',()=>{l.innerHTML='Carregando conteúdos patrocinados...';loadSponsoredContent()})}}function renderSponsoredContent(items){const c={filmes:document.getElementById('filmes-grid'),series:document.getElementById('series-grid'),animes:document.getElementById('animes-grid')};const s={filmes:document.getElementById('filmes-section'),series:document.getElementById('series-section'),animes:document.getElementById('animes-section')};items.forEach(it=>{sdc.push(it);const cd=document.createElement('div');cd.className='media-card';cd.dataset.id=it.id;const p=it.poster_path?`${TMDB_IMG_URL}${it.poster_path}`:'https://via.placeholder.com/200x300?text=Sem+Imagem';cd.innerHTML=`<img src="${p}" alt="Pôster de ${it.title||it.name}"><div class="media-card-title">${it.title||it.name}</div>`;let k;if(it.media_type_custom==='movie'){k='filmes';s.filmes.classList.remove('hidden');c.filmes.appendChild(cd)}else{const ia=it.genres&&it.genres.some(g=>g.id===16);if(ia){k='animes';s.animes.classList.remove('hidden');c.animes.appendChild(cd)}else{k='series';s.series.classList.remove('hidden');c.series.appendChild(cd)}}cd.dataset.type=k;cd.addEventListener('click',()=>showSponsoredDetailsModal(it.id))})}function showSponsoredDetailsModal(id){const it=sdc.find(d=>d.id==id);if(!it)return;document.getElementById('modal-poster').src=it.poster_path?`${TMDB_IMG_URL}${it.poster_path}`:'https://via.placeholder.com/200x300?text=Sem+Imagem';document.getElementById('modal-title').textContent=it.title||it.name;document.getElementById('modal-synopsis').textContent=it.overview||'Sinopse não disponível.';const mc=document.getElementById('modal-meta');mc.innerHTML='';document.getElementById('modal-info-tv').classList.toggle('hidden',it.media_type_custom==='movie');document.getElementById('modal-genres-container').classList.toggle('hidden',it.media_type_custom!=='movie');if(it.media_type_custom==='movie'){const y=it.release_date?it.release_date.split('-')[0]:'N/A';mc.innerHTML=`<span>Filme</span><span>${y}</span><span>${formatDuration(it.runtime)}</span>`;const gc=document.getElementById('modal-genres');if(it.genres){gc.innerHTML=it.genres.slice(0,3).map(g=>`<span>${g.name}</span>`).join('')}}else{const t=it.genres&&it.genres.some(g=>g.id===16)?'Anime':'Série';const y=it.first_air_date?it.first_air_date.split('-')[0]:'N/A';mc.innerHTML=`<span>${t}</span><span>${y}</span>`;const teg=document.getElementById('modal-total-eps-group');if(it['Episódios Totais']&&it['Episódios Totais'].toString().trim()!==''){populateInfoTags('modal-total-eps',it['Episódios Totais']);teg.classList.remove('hidden')}else{teg.classList.add('hidden')}populateInfoTags('modal-sponsored-eps',it['Episódios Patrocinados']);populateInfoTags('modal-watched-eps',it['Episódios Assistidos'])}populateInfoTags('modal-sponsor',it.Patrocinador);document.getElementById('details-modal').classList.add('visible')}async function loadAssistidosContent(){try{const r=await fetch(ASSISTIDOS_DATA_URL);if(!r.ok)throw new Error('Falha ao buscar dados do Google Script.');const i=await r.json();const di=await Promise.all(i.map(async(it)=>{const id=it['ID DO TMDB'];if(!id)return null;const m=!it['Episódios Patrocinados']&&!it['Episódios Assistidos '];const mt=m?'movie':'tv';const u=`${TMDB_BASE_URL}/${mt}/${id}?api_key=${TMDB_API_KEY}&language=pt-BR`;const tr=await fetch(u);if(!tr.ok)return null;const td=await tr.json();return{...it,...td,media_type_custom:mt}}));document.getElementById('assistidos-loading-message').classList.add('hidden');renderAssistidosContent(di.filter(it=>it!==null))}catch(e){console.error('Erro ao carregar conteúdo assistido:',e);const l=document.getElementById('assistidos-loading-message');l.innerHTML=`<div class="error-notice" style="margin-bottom:20px;text-align:left;">Erro ao carregar os dados. Tente novamente mais tarde.</div><button id="retry-assistidos" class="change-button" style="background:var(--accent-primary);color:var(--text-primary);border-color:var(--accent-primary);">Tentar Novamente</button>`;l.querySelector('#retry-assistidos').addEventListener('click',()=>{l.innerHTML='Carregando conteúdos assistidos...';loadAssistidosContent()})}}function renderAssistidosContent(items){const c={filmes:document.getElementById('assistidos-filmes-grid'),series:document.getElementById('assistidos-series-grid'),animes:document.getElementById('assistidos-animes-grid')};const s={filmes:document.getElementById('assistidos-filmes-section'),series:document.getElementById('assistidos-series-section'),animes:document.getElementById('assistidos-animes-section')};items.forEach(it=>{adc.push(it);const cd=document.createElement('div');cd.className='media-card';cd.dataset.id=it.id;const p=it.poster_path?`${TMDB_IMG_URL}${it.poster_path}`:'https://via.placeholder.com/200x300?text=Sem+Imagem';cd.innerHTML=`<img src="${p}" alt="Pôster de ${it.Título}"><div class="media-card-title">${it.Título}</div>`;let k;if(it.media_type_custom==='movie'){k='filmes';s.filmes.classList.remove('hidden');c.filmes.appendChild(cd)}else{const ia=it.genres&&it.genres.some(g=>g.id===16);if(ia){k='animes';s.animes.classList.remove('hidden');c.animes.appendChild(cd)}else{k='series';s.series.classList.remove('hidden');c.series.appendChild(cd)}}cd.dataset.type=k;cd.addEventListener('click',()=>showAssistidosDetailsModal(it.id))})}function showAssistidosDetailsModal(id){const it=adc.find(d=>d.id==id);if(!it)return;document.getElementById('assistidos-modal-poster').src=it.poster_path?`${TMDB_IMG_URL}${it.poster_path}`:'https://via.placeholder.com/200x300?text=Sem+Imagem';document.getElementById('assistidos-modal-title').textContent=it.Título;document.getElementById('assistidos-modal-synopsis').textContent=it.overview||'Sinopse não disponível.';document.getElementById('assistidos-modal-rating').innerHTML=renderStars(it['Nota da Lorena']);const mc=document.getElementById('assistidos-modal-meta');mc.innerHTML='';document.getElementById('assistidos-modal-info-tv').classList.toggle('hidden',it.media_type_custom==='movie');document.getElementById('assistidos-modal-genres-container').classList.toggle('hidden',it.media_type_custom!=='movie');if(it.media_type_custom==='movie'){const y=it.release_date?it.release_date.split('-')[0]:'N/A';mc.innerHTML=`<span>Filme</span><span>${y}</span><span>${formatDuration(it.runtime)}</span>`;const gc=document.getElementById('assistidos-modal-genres');if(it.genres){gc.innerHTML=it.genres.slice(0,3).map(g=>`<span>${g.name}</span>`).join('')}}else{const t=it.genres&&it.genres.some(g=>g.id===16)?'Anime':'Série';const y=it.first_air_date?it.first_air_date.split('-')[0]:'N/A';mc.innerHTML=`<span>${t}</span><span>${y}</span>`;populateInfoTags('assistidos-modal-sponsored-eps',it['Episódios Patrocinados']);populateInfoTags('assistidos-modal-watched-eps',it['Episódios Assistidos '])}populateInfoTags('assistidos-modal-sponsor',it.Patrocinador);document.getElementById('assistidos-details-modal').classList.add('visible')}document.querySelectorAll('.nav-link').forEach(l=>{l.addEventListener('click',function(){const t=this.dataset.tab;if(t==='patrocinados'&&!isl){loadSponsoredContent();isl=true}if(t==='assistidos'&&!ial){loadAssistidosContent();ial=true}})})})();function formatDuration(m){if(!m||m===0)return'Duração não disponível';const h=Math.floor(m/60);const mn=m%60;return h>0?`${h}h ${mn}m`:`${mn}m`}init()</script></body></html>
